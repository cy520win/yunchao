<extend name="Public:base" />
<block name="title"><title>高顿实习</title></block>
<block name="right-main">
    <div class="col-sm-12">

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">增加职位信息</h3>
                <div class="panel-options">
                    <a href="#" data-toggle="panel">
                        <span class="collapse-icon">&ndash;</span>
                        <span class="expand-icon">+</span>
                    </a>
                </div>
            </div>
            <div class="panel-body">

                <form action="/index.php?s=/Admin/Post/save" method="post" role="form" class="form-horizontal">

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">职位名称：</label>

                        <div class="col-sm-4">
                            <input type="text" class="form-control" id="field-1" name="title">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">企业名称：</label>

                        <div class="col-sm-4">
                            <select class="form-control" name="enterprise_id">
                                <foreach name="list['enterpriselist']" item="enterpriseItem" key="key">
                                    <option value="{$key}">
                                        {$enterpriseItem.full_name}
                                    </option>
                                </foreach>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">每周至少：</label>
                        <div class="col-sm-2">
                            <select class="form-control" name="week_available">
                                <foreach name="list['weeklist']" item="weekItem" key="key">
                                    <option value="{$key}">
                                        {$weekItem}
                                    </option>
                                </foreach>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-5">省份：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="province_id" id="province_id">
                                <option value="0">省</option>
                                <foreach name="list['provincelist']" item="provinceItem">
                                    <option value="{$provinceItem.region_id}">
                                        {$provinceItem.region_name}
                                    </option>
                                </foreach>
                            </select>
                        </div>
                        <label class="col-sm-2 control-label" for="field-5">城市：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="city_id" id="city_id">
                                <option value="0">市</option>
                            </select>
                        </div>
                    </div>


                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-5">实习地址：</label>

                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="field-1" name="address">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-5">名额数量：</label>

                        <div class="col-sm-2">
                            <input type="text" class="form-control" id="field-1" name="quota">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-5">留用机会：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="keep_on">
                                <option value="1">有</option>
                                <option value="2">未留</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">学历要求：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="education">
                                <foreach name="list['edulist']" item="eduItem" key="key">
                                    <option value="{$key}">
                                        {$eduItem}
                                    </option>
                                </foreach>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">专业分类：</label>
                        <div class="col-sm-10" id="major-input-div">
                                <input type="checkbox" name="major_wish[]" value="0" class="major-input">不限
                               <foreach name="list['majorlist']" item="majorItem" key="key">
                                    <input type="checkbox" name="major_wish[]" value="{$key}" class="major-input">{$majorItem}
                                </foreach>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">职位分类：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="category_id">
                                <foreach name="list['categorylist']" item="categoryItem" key="key">
                                    <option value="{$key}">
                                        {$categoryItem}
                                    </option>
                                </foreach>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">毕业年份：</label>

                        <div class="col-sm-6 control-label" id="graduate_year">
                            <foreach name="list['graduatelist']" item="graduateItem" key="key">
                                <label>
                                    <input type="checkbox" class="cbr cbr-secondary" value="{$key}" name="graduate_year[]">
                                    {$graduateItem}
                                </label>
                                &nbsp;
                            </foreach>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">职位描述：</label>

                        <div class="col-sm-10">
                            <textarea name="description" class="form-control" cols="15" id="field-5"
                                      style="height:150px;"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">状态：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="status">
                                <option value="1">显示</option>
                                <option value="2">隐藏</option>

                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">首页展示：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="home_show">
                                <option value="1">是</option>
                                <option value="2">否</option>

                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-1">热门岗位：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="is_hot">
                                <option value="1">是</option>
                                <option value="2">否</option>

                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="field-5">排序号：</label>

                        <div class="col-sm-2">
                            <input type="text" class="form-control" id="field-1" name="order_num">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">日薪范围：</label>

                        <div class="col-sm-2">
                            <select class="form-control" name="salary_range">
                                <foreach name="list['salarylist']" item="salaryItem" key="key">
                                    <option value="{$key}">
                                        {$salaryItem}
                                    </option>
                                </foreach>
                            </select>
                        </div>

                    </div>
                    <div class="form-group" style="padding-top:10px;">
                        <div class="col-sm-12" style="margin:auto text-align:center;">
                            <div class="container" style="width:145px;">
                                <button type="submit" class="btn btn-turquoise">提交</button>
                                <button type="button" class="btn btn-red"
                                        onclick="javascript:location.href='/index.php?s=/Admin/Post/index'">返回
                                </button>
                            </div>

                        </div>
                    </div>

                </form>

            </div>
        </div>

    </div>
</block>
<block name="script">
    <script>
        $(function(){

            $('#province_id').change(function()
            {
                var id = $(this).val();
                $.get('/index.php?s=/Admin/Post/cityList',{parentId : id},function(data){
                    $("#city_id").html(data);
                })
            });

            $('form').submit(function(){
                var parm = $(this).serialize();
                var bool = true;

                var length = $('.cbr:checked').length;
                var length2 = $('.major-input:checked').length;
                if(length < 1)
                {
                    alert(length);
                    $('#graduate_year').css({'border':'1px solid #ffcc00'});
                    bool = false;
                }

                if(length2 < 1)
                {
                    $('#major-input-div').css({'border':'1px solid #ffcc00'});
                    bool = false;
                }

                var province_id = $('#province_id').val();
                if(province_id <710000){
                    if($('#city_id').val()<1 || !$('#city_id').val()){
                        $('#city_id').css({'border':'1px solid #ffcc00'});
                        bool = false;
                    }                    
                }
                $.ajax({
                    type: "post",
                    async:false,
                    url: "/index.php?s=/Admin/Post/checkMessage",
                    dataType:"json",
                    data: parm,
                    success: function(msg){

                        if(msg.title){
                            $('input[name=title]').css('border','1px solid #ffcc00');
                            bool = false;
                        }
                        if(msg.address){
                            $('input[name=address]').css('border','1px solid #ffcc00');
                            bool = false;
                        }
                        if(msg.quota){
                            $('input[name=quota]').css('border','1px solid #ffcc00');
                            bool = false;
                        }
                        if(msg.description){
                            $('textarea[name=description]').css('border','1px solid #ffcc00');
                            bool = false;
                        }
                        if(msg.province_id){
                            $('#province_id').css('border','1px solid #ffcc00');
                            bool = false;
                        }

                    },
                    error:function(){}
                });

                return bool;
            });
        })
    </script>
</block>